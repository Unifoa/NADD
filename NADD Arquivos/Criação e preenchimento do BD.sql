CREATE USER nadd IDENTIFIED BY nadd;
grant CREATE SESSION, ALTER SESSION, CREATE DATABASE LINK, CREATE MATERIALIZED VIEW, CREATE PROCEDURE, CREATE PUBLIC SYNONYM, CREATE ROLE, CREATE SEQUENCE, CREATE SYNONYM, CREATE TABLE, CREATE TRIGGER, CREATE TYPE, CREATE VIEW, UNLIMITED TABLESPACE to nadd;

-- Criar uma nova conexão com o usuário criado acima.

CREATE TABLE TABELA_AREA(	
AREA_ID NUMBER NOT NULL, 
AREA_NOME VARCHAR2(20) NOT NULL,
CONSTRAINT PK_TABELA_AREA 
    PRIMARY KEY(AREA_ID)
);

CREATE TABLE TABELA_CURSO(
CUR_ID NUMBER NOT NULL, 
CUR_AREA NUMBER NOT NULL, 
CUR_NOME VARCHAR2(30) NOT NULL, 
CUR_NUM_PERIODOS NUMBER(2),
CONSTRAINT PK_TABELA_CURSO 
    PRIMARY KEY(CUR_ID),
CONSTRAINT FK_TABELA_CURSO 
    FOREIGN KEY(CUR_AREA) 
    REFERENCES TABELA_AREA(AREA_ID)
);

CREATE TABLE TABELA_DISCIPLINA( 
DIS_ID NUMBER NOT NULL, 
DIS_CURSO NUMBER NOT NULL, 
DIS_NOME VARCHAR2(80) NOT NULL, 
DIS_PERIODO NUMBER(2) NOT NULL, 
DIS_ANO NUMBER(4) NOT NULL,
CONSTRAINT PK_TABELA_DISCIPINA 
    PRIMARY KEY(DIS_ID, DIS_PERIODO, DIS_ANO),
CONSTRAINT FK_TABELA_DISCIPLINA 
    FOREIGN KEY(DIS_CURSO) 
    REFERENCES TABELA_CURSO(CUR_ID)
);

CREATE TABLE TABELA_PROFESSOR( 
PROF_ID NUMBER NOT NULL, 
PROF_MATRICULA NUMBER NOT NULL, 
PROF_NOME VARCHAR2(80) NOT NULL,
CONSTRAINT PK_TABELA_PROFESSOR 
    PRIMARY KEY(PROF_ID),
CONSTRAINT UK_TABELA_PROFESSOR 
    UNIQUE(PROF_MATRICULA)
);

CREATE TABLE TABELA_DIS_PROF( 
DEP_DISCIPLINA NUMBER NOT NULL, 
DEP_NUM_PERIODO NUMBER(2) NOT NULL, 
DEP_ANO NUMBER(4) NOT NULL, 
DEP_PROFESSOR NUMBER NOT NULL,
CONSTRAINT PK_TABELA_DIS_PROF 
    PRIMARY KEY(DEP_DISCIPLINA, DEP_NUM_PERIODO, DEP_ANO, DEP_PROFESSOR),
CONSTRAINT FK_TABELA_DIS_PROF 
    FOREIGN KEY(DEP_DISCIPLINA, DEP_NUM_PERIODO, DEP_ANO) 
    REFERENCES TABELA_DISCIPLINA(DIS_ID, DIS_PERIODO, DIS_ANO),
CONSTRAINT FK_TABELA_DIS_PROF2 
    FOREIGN KEY(DEP_PROFESSOR) 
    REFERENCES TABELA_PROFESSOR(PROF_ID)
);

CREATE TABLE TABELA_PROVA(
PROVA_ID NUMBER NOT NULL, 
PROVA_DISCIPLINA NUMBER NOT NULL, 
PROVA_PERIODO NUMBER(2) NOT NULL, 
PROVA_ANO NUMBER(4) NOT NULL, 
PROVA_ID_PROFESSOR NUMBER NOT NULL, 
PROVA_QNT_QUESTAO NUMBER NOT NULL, 
PROVA_VALOR_EXPLICITO NUMBER(1) DEFAULT 0, 
PROVA_VALOR_PROVA DECIMAL(3,2), 
PROVA_EQUILIBRIO_QUESTAO NUMBER(1) DEFAULT 0, 
PROVA_REF_BIBLIOGRAFICA NUMBER(1) DEFAULT 0,
CONSTRAINT PK_TABELA_PROVA 
    PRIMARY KEY(PROVA_ID),
CONSTRAINT FK_TABELA_PROVA 
    FOREIGN KEY(PROVA_DISCIPLINA, PROVA_PERIODO, PROVA_ANO, PROVA_ID_PROFESSOR) 
    REFERENCES TABELA_DIS_PROF(DEP_DISCIPLINA, DEP_NUM_PERIODO, DEP_ANO, DEP_PROFESSOR)
);

CREATE TABLE TABELA_AVALIACAO(
AVA_PROVA NUMBER NOT NULL, 
AVA_CLAREZA DECIMAL(3,2) NOT NULL, 
AVA_COMPLEXIDADE DECIMAL(3,2) NOT NULL, 
AVA_CONTEXTUALIZACAO NUMBER(1) NOT NULL, 
AVA_OBSERVACAO VARCHAR2(2000), 
AVA_QUESTAO NUMBER NOT NULL, 
AVA_QUESTAO_EXPLICITO NUMBER(1) NOT NULL, 
AVA_VALOR_QUESTAO DECIMAL(3,2) NOT NULL, 
AVA_MULT_ESCOLHA NUMBER(1) NOT NULL,
CONSTRAINT PK_TABELA_AVALIACAO 
    PRIMARY KEY(AVA_PROVA, AVA_QUESTAO),
CONSTRAINT FK_TABELA_AVALIACAO 
    FOREIGN KEY(AVA_PROVA) 
    REFERENCES TABELA_PROVA(PROVA_ID)
);


CREATE TABLE TABELA_PERFIL(
PERF_ID NUMBER NOT NULL, 
PERF_NOME VARCHAR2(40) NOT NULL,
CONSTRAINT PK_TABELA_PERFIL 
    PRIMARY KEY(PERF_ID)
);

CREATE TABLE TABELA_USUARIO(
USU_ID NUMBER NOT NULL,
USU_NOME VARCHAR2(80) NOT NULL,
USU_SENHA VARCHAR2(18) NOT NULL, 
USU_PERFIL NUMBER NOT NULL,
CONSTRAINT PK_TABELA_USUARIO PRIMARY KEY(USU_ID),
CONSTRAINT FK_TABELA_USUARIO FOREIGN KEY(USU_PERFIL) 
    REFERENCES TABELA_PERFIL(PERF_ID)
);

CREATE SEQUENCE SEQ_TABELA_CURSO
INCREMENT BY 1 START WITH 1 MAXVALUE 50 NOCYCLE;


-- INSERT AREA
INSERT INTO TABELA_AREA VALUES(1,'EXATAS');
INSERT INTO TABELA_AREA VALUES(2,'HUMANAS');
INSERT INTO TABELA_AREA VALUES(3,'SAUDE');

--INSERT CURSO
INSERT INTO TABELA_CURSO VALUES(SEQ_TABELA_CURSO.NEXTVAL,1,'SISTEMAS DE INFORMAÇÃO',8);
INSERT INTO TABELA_CURSO VALUES(SEQ_TABELA_CURSO.NEXTVAL,3,'ODONTOLOGIA',10);
-- insert feito depois para o segundo bimestre
INSERT INTO TABELA_CURSO VALUES(SEQ_TABELA_CURSO.NEXTVAL,1,'ENGENHARIA CIVIL',10);


--INSERT DISCIPLINA
INSERT INTO TABELA_DISCIPLINA VALUES(1,1,'ALGORITMOS 1','1','2019');
INSERT INTO TABELA_DISCIPLINA VALUES(2,1,'AMBIENTE WEB 1','1','2019');
INSERT INTO TABELA_DISCIPLINA VALUES(3,2,'ANATOMIA DENTAL','2','2019');
-- insert feito depois para o segundo bimestre
INSERT INTO TABELA_DISCIPLINA VALUES(4,2,'BIOQUIMICA', 1, 2019);  

--INSERT PERFIL
INSERT INTO TABELA_PERFIL VALUES(1,'ADMINISTRADOR');
INSERT INTO TABELA_PERFIL VALUES(2,'AVALIADOR');

-- INSERT USUARIO
INSERT INTO TABELA_USUARIO VALUES(1,'PEDRO ALCANTARA DA SILVA','SENHA1',1);
INSERT INTO TABELA_USUARIO VALUES(2,'BRUNA CASIRAGHI','SENHA2',2);

--INSERT PROFESSOR
INSERT INTO TABELA_PROFESSOR VALUES(1,20190001,'PEDRO AUGUSTO PEIXOTO BITTENCOURT');
INSERT INTO TABELA_PROFESSOR VALUES(2,20190002,'DEBORA AMORIM DE CARVALHO');
INSERT INTO TABELA_PROFESSOR VALUES(3,20190003,'MARCELO PASSOS DOS SANTOS');

--INSERT DIS_PROF
INSERT INTO TABELA_DIS_PROF VALUES (1,'1','2019',2);
INSERT INTO TABELA_DIS_PROF VALUES (2,'1','2019',3);
INSERT INTO TABELA_DIS_PROF VALUES (3,'2','2019',1);

-- INSERT PROVA
INSERT INTO TABELA_PROVA VALUES (1,3,'2','2019',1,8,1,1,0,0);
INSERT INTO TABELA_PROVA VALUES (2,2,'1','2019',3,5,0,0,1,1);

-- INSERT AVALIACAO
INSERT INTO TABELA_AVALIACAO VALUES(1,0.50,0.75,2,'BOM',1,1,1.5,0);
INSERT INTO TABELA_AVALIACAO VALUES(1,0.25,0.50,1,'MUITO BOM',2,1,2.5,1);
INSERT INTO TABELA_AVALIACAO VALUES(2,0.75,1,4,'REGULAR',1,0,0,1);
INSERT INTO TABELA_AVALIACAO VALUES(2,0.25,0.75,2,'RUIM',2,1,3,0);


--TESTE--
SELECT * FROM TABELA_avaliacao;